# Ещё один анализ GPX трека (YAGTA)

Предлагаемый метод можно использовать для анализа рутинных поездок и 
получения представления об общем соотношении легких и трудных участков.
Чем большее время скорость близка к средней или выше её, тем равномернее движение по дистанции.

Факторами замедления могут быть: 

- сложные подъёмы, 
- светофоры с длинным циклом, под которые сложно подкатиться без остановки, 
- участки с плохим покрытием,
- пр...идумайте сами.

## Описание метода

Описание метода прочитано в первой главе книги Сергея Самойленко «Вероятности и неприятности» [1]
Читать от слов "Закон велосипедиста":

Чтобы увидеть распределение скоростей, отрезки пути упорядочиваются по скорости от самых медленных до самых быстрых.
Полученная обобщающая картина, отражает то, что можно было бы условно назвать «справедливостью» распределения. 
Более того, если вместо одного велосипедиста проанализировать группу спортсменов, ездящих по этому маршруту в произвольном направлении, 
то диаграмма практически не изменится, разве что несколько сгладится из-за разброса скоростей. 

Ее смысл останется прежним: она покажет, насколько этот маршрут отклоняется от самого справедливого, 
на котором время преодоления участка не зависит от его «трудности», а определяется только его длиной.

## Как работает

Скопировать файлы trek.html, trek.js в каталог на компьютере. Открыть в браузере trek.html.
На смартфоне локальные файлы работали до Android 7.

Из gpx-трека извлекаются все теги точек. 
По координатам с помощью формулы гаверсинуса [2] определяется пройденное расстояние между точками. 
По меткам времени - затраченное на это расстояние время.

Параметр "Каждую [ ] точку" позволяет обработать лишь некоторые точки из трека, что может довольно сильно исказить результат анализа.
Тем не менее, перед анализом можно трек отфильтровать от точек с небольшим смещением и обрезать "бороды" в начале и конце.
Сделать это можно, например, в приложении OsmAnd.

Полученный массив точек сортируется по скорости прохождения отрезка и на график [3] наносятся накопленные доли пройденного расстояния и затраченного времени.

## Ссылки

1. [С. Самойленко «Вероятности и неприятности». Глава из книги](https://elementy.ru/bookclub/chapters/436883/Veroyatnosti_i_nepriyatnosti_Glava_iz_knigi)
2. [A simple haversine formula module for Node.js](https://github.com/njj/haversine)
3. [Chart.js](https://www.chartjs.org/)

## З.Ы.

Если я что не так понял или сделал, прошу поправить.
